---
title: "【ComfyUI】Cumulative system RAM leak requiring full PC restart on RTX 5070 (Blackwell) with Wan2.2 GGUF (Q4/Q8), multiple runs"
description: "ComfyUIのエラー 'Cumulative system RAM leak requiring full PC restart on RTX 5070 (Blackwell) with Wan2.2 GGUF (Q4/Q8), multiple runs' の解決策まとめ。Python環境やカスタムノードの不具合を直す方法。"
pubDate: "2026-01-13"
---

## エラーの概要

ComfyUI上でWan2.2 GGUF (Q4/Q8)モデルを使用して複数回生成を行うと、システムRAMのリークが発生し、再起動が必要になる。VRAMは解放されるが、システムRAMは次第に消費され続け、最終的にOutOfMemoryError(OOM)を引き起こす。

## 原因

この問題は主に以下の要因による：

- **Python環境の不具合**: 環境変数や依存ライブラリの設定が正しくない場合、メモリー管理が不完全になり、メモリーリークを引き起こす。
- **ComfyUIカスタムノードのバグ**: 特定のカスタムノードが正常に解放されないまま残っていると、システムRAMのリークにつながる。

## 解決策

### 1. Python環境の確認と調整

Pythonの依存関係やバージョンを最新かつ適切なものにする：

```sh
pip install --upgrade pip
pip install torch==<version> transformers==<version>
```

### 2. カスタムノードのチェック

カスタムノードが問題の原因である可能性があるため、以下の手順で確認する：

- **カスタムノードを無効にする**:
    - メニューから「Settings (設定)」 > 「Custom Nodes (カスタムノード)」 > 「Disable all custom nodes (全てのカスタムノードを無効化)」を選択。
    
- **カスタムノードリストの確認**: 
    - 無効化が完了したら、まだ存在するカスタムノードのリストを確認し、問題のあるノードがあるかどうかを調査。

### 3. バックエンド処理の調整

メモリーリークを防ぐために以下のコマンドを実行：

```sh
torch.cuda.empty_cache()
import gc; gc.collect()
```

これらのコマンドは、ComfyUIが使用しているPyTorch環境での不要なテンソルやバッファを強制的に解放する。

### 4. ComfyUIの再起動と確認

上述の手順を行った後も問題が解決しない場合は、以下のステップを試す：

- **ComfyUIを完全に終了し、再度実行**:
    - `killall python` または `taskkill /F /IM python.exe` を使用してプロセスを強制終了。
    
- **再起動後はメモリー状態を確認**: 
    - 環境がクリアになったことを確認し、再度生成処理を行う。

## まとめ

この問題の解決にはPython環境とカスタムノードの検討が必要です。適切な依存関係管理を行い、不要なメモリーリソースを強制的に解放することで、ComfyUIでの生成処理を安定化させることができます。