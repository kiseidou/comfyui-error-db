---
title: "【ComfyUI】fix(api-nodes): do not downscale the input image for Topaz Enhance"
description: "ComfyUIのエラー 'fix(api-nodes): do not downscale the input image for Topaz Enhance' の解決策まとめ。Python環境やカスタムノードの不具合を直す方法。"
pubDate: "2026-01-13"
---

## エラーの概要

このエラーは、Topaz Enhanceノードを使用して画像処理を行う際に発生します。主に高解像度（4MPを超える）の画像を入力として使用した場合に問題が見られます。

## 原因

現在の実装では、ComfyUIはすべての入力画像を自動的に`4MP`までダウンスケーリングしています。これにより、6MPや8MPなどのより高解像度のソース画像に対して処理を行う場合に品質の損失が発生します。

## 解決策

### Python環境での修正手順
1. **Pythonスクリプトを編集する**:
   - まず、`comfy/api-nodes.py`ファイルを開きます。
   - `topaz_enhance`関数を見つけます。その中で、画像のダウンスケーリング処理が行われています。
   - 下記のようなコードを削除またはコメントアウトします。

     ```python
     # 下記の行を削除またはコメントアウトする
     image = image.resize((4096, 2160))
     ```

2. **変更を保存してComfyUIを再起動**:
   - `api-nodes.py`ファイルに変更を加えた後、保存し、ComfyUIサーバーを停止し、再度起動します。
   
   ```bash
   # ComfyUIのサーバーを止める
   python3 app.py stop
   
   # リスタートする
   python3 app.py start
   ```

### カスタムノードを使用する場合

1. **カスタムノードスクリプトに修正を加える**:
   - 自作のTopaz Enhance用カスタムノードがある場合は、そのスクリプトを開きます。
   - 同様に、画像ダウンスケーリング処理を行っている部分を見つけます。
   - それらのコードを削除またはコメントアウトします。

2. **ComfyUIリロード**:
   - 変更を保存後、ComfyUIを再起動します。これにより変更が反映されます。

## まとめ

入力画像の品質損失を防ぐためには、Topaz Enhanceノードが自動で行っている画像ダウンスケーリング処理を手動で抑制する必要があります。上記の手順に従ってPythonスクリプトまたはカスタムノードコードを修正し、ComfyUIを再起動することでエラーは解決します。

ただし、この修正によりメモリ使用量や処理時間が増えますので、システムの負荷に注意してください。