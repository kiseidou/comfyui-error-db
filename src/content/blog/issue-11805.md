---
title: "【ComfyUI】Support ModelScope-Trainer/DiffSynth LoRA format for Z-Image models"
description: "ComfyUIのエラー 'Support ModelScope-Trainer/DiffSynth LoRA format for Z-Image models' の解決策まとめ。Python環境やカスタムノードの不具合を直す方法。"
pubDate: "2026-01-13"
---

## エラーの概要

このエラーは、特定のモデル（ModelScope-Trainer/DiffSynth）で学習したLoRA（Layer-wise Adaptive Rate Scaling）データを使用しようとした際に発生します。主に、Z-Imageという特定の画像生成モデルを用いたときに出ます。

## 原因

原因としては、ComfyUIが既存のLoRAフォーマットに対応していないか、または追加で必要な依存関係や更新が必要な場合があります。また、カスタムノードに問題がある可能性もあります。

## 解決策

1. **Python環境と依存関係を確認する**
   - Pythonのバージョンが最新であることを確認します。
   ```bash
   python --version
   ```
   - 必要なパッケージ（例えばtorch、torchvision、diffusers等）がインストールされているか確認します。
   ```bash
   pip list | grep torch
   pip list | grep diffusers
   ```

2. **カスタムノードの更新または修正**
   - GitHubリポジトリを最新バージョンにプッシュアップデートします。
   ```bash
   git pull origin main
   ```
   - カスタムノードが適切にインポートされているか確認し、必要なら修正します。

3. **LoRAフォーマットのサポート追加**
   - ディレクトリ `custom_nodes/ComfyUI_LoRA` にあるファイルを編集して、ModelScope-Trainer/DiffSynthのLoRA形式に対応させる。
   ```python
   # custom_nodes/CompyUI_LoRA/load_lora.py
   def load_checkpoint(node_info, **kwargs):
       # 新しいフォーマットのサポートを追加するコード
       pass
   ```
   
4. **エラーが出るノードやプロセスを特定**
   - エラーログを詳細に確認し、どのファイルや関数で問題が発生したか特定します。
   ```bash
   # 例：エラーメッセージのトレースバック部分から特定の行を探します。
   File "/path/to/custom_nodes/ComfyUI_LoRA/load_lora.py", line 42, in load_checkpoint raise ValueError("Unsupported LoRA format.")
   ```
   
5. **問題箇所の修正**
   - 該当するファイルを開き、該当行を確認します。
   ```bash
   vim /path/to/custom_nodes/ComfyUI_LoRA/load_lora.py
   # または
   nano /path/to/custom_nodes/ComfyUI_LoRA/load_lora.py
   ```
   - 必要な修正を行った後、ファイルを保存し、システムを再起動します。

## まとめ

このエラーは、特定のフォーマットのLoRAデータを読み込む際の不具合が原因で発生します。Python環境の更新やカスタムノードの調整により解決することが可能です。エラーメッセージから情報を得て適切な対策を講じることが重要です。

以上、ComfyUIでのModelScope-Trainer/DiffSynth LoRA形式のサポート追加に関する記事でした。